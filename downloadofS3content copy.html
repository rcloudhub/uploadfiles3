<!DOCTYPE html>
<html>
<head>
    <title>Upload File to AWS S3</title>
</head>
<body>
    <h2>Upload File to AWS S3</h2>

    <?php
    // Set your AWS credentials and region
    $AWS_ACCESS_KEY_ID = 'AKIA2UC3A23OPRRF74DU';
    $AWS_SECRET_ACCESS_KEY = 'w1ZHb79E55O1jTfwGSaILQYyevhogg3EYeStVE8y';
    $AWS_REGION = 'eu-north-1';
    $BUCKET_NAME = 'rcloudhubn';

    // Function to upload file to S3
    function upload_file_to_s3($file_path, $key_name) {
        require 'vendor/autoload.php';
        use Aws\S3\S3Client;
        use Aws\Exception\AwsException;

        $s3 = new S3Client([
            'version' => 'latest',
            'region' => $GLOBALS['AWS_REGION'],
            'credentials' => [
                'key' => $GLOBALS['AWS_ACCESS_KEY_ID'],
                'secret' => $GLOBALS['AWS_SECRET_ACCESS_KEY'],
            ]
        ]);

        try {
            $result = $s3->putObject([
                'Bucket' => $GLOBALS['BUCKET_NAME'],
                'Key' => $key_name,
                'Body' => fopen($file_path, 'rb'),
                'ACL' => 'public-read' // Adjust ACL as per your requirement
            ]);

            echo "File uploaded successfully.";
        } catch (AwsException $e) {
            echo "Error uploading file: " . $e->getMessage();
        }
    }

    // Check if form is submitted
    if ($_SERVER["REQUEST_METHOD"] == "POST" && isset($_POST["submit"])) {
        $file_name = $_FILES["fileToUpload"]["name"];
        $file_temp = $_FILES["fileToUpload"]["tmp_name"];

        if ($file_name) {
            upload_file_to_s3($file_temp, $file_name);
        } else {
            echo "Please select a file to upload.";
        }
    }
    ?>

    <form action="<?php echo htmlspecialchars($_SERVER["PHP_SELF"]); ?>" method="post" enctype="multipart/form-data">
        <input type="file" name="fileToUpload" id="fileToUpload">
        <input type="submit" value="Upload File" name="submit">
    </form>
</body>
</html>
